# Mini python mail
## Проект по PyQt5

Приложение написано для оттачивания навыков работы с библиотеками PyQt5 и sqlite3. Оно представляет из себя очень упрощенную электронную почту, которая хранит все данные о пользователях и самих сообщениях в БД, позволяет читать сообщения, перемещать их в корзину, удалять сообщения полностью или отправить новое сообщение другому зарегистрированному пользователю.

# Эксплуатация
Работа приложения начинается с модуля Login. Там вас ожидает рандомное приветствие, поля для ввода логина и пароля, 2 ссылки "Забыли пароль?" и "Нет аккаунта? Зарегистрируйтесь" и кнопка для входа в аккаунт. Вы можете зарегистрировать новый аккаунт, нажав "Нет аккаунта? Зарегистрируйтесь". Это кликабельный Label, для него создан отдельный класс. Новый аккаунт не будет содержать писем, но вы можете их сами написать. Вот 2 аккаунта, которые уже были созданы для тестирования работы с письмами:
1) Логин: God;   
Пароль: 123456789Qq
2) Логин: Aleksandr1799;    
Пароль: 12345678Qq

После регистрации, вы сможете зайти на свой аккаунт. Если вы забыли свой пароль, то можете его восстановить, нажав на кнопку "Забыли пароль?".  
После входа в аккаунт, вы окажетесь в основном меню программы. Там есть кнопка "Написать письмо", которая откроет новую форму, где вы можете указать тему письма, получателя (он должен быть обязательно, иначе письмо не отправится) и текст самого письма. Если вы зарегистрируйте новый аккаунт, то QTableWidget будет пуст. В нём хранятся основные сведения о письмам, которые вы можете почитать в пункте **Модули и их назначение**. Чтобы открыть письмо, нажмите на него два раза левой кнопкой мыши или правой кнопкой мыши + открыть письмо (При этом действии откроется отдельное окно, которое содержит данные о письме и его текст). Также, вы можете пометить письмо как прочитанное/непрочитанное и переместить письмо в корзину нажав правую кнопку мыши + соответствующее действие. В корзине открываются действия Восстановить письмо и Удалить письмо безвозвратно.     
Письма отсортированны по дате получения от наиболее раннего к наиболее позднему. Можно выбрать категории писем для отображение. Для этого выберете соответствующую категорию, которые будут слева от QTableWidget. Вы можете выбрать категории: все, прочитанные, непрочитанные, отправленные, полученные, корзина. 
Сверху есть строка для поиска по письмам. Вы можете искать совпадение по всем письмам или выбрав некоторую категорию.    
Можно выбирать письма, которые были отправлены/получены в определенную дату. Для этого есть виджет QCalendarWidget, где вы можете выбрать необходимую дату. Чтобы снять фильтр от QCalendarWidget, нажмите на категорию "Все".
Над QCalendarWidget есть информация о текущем пользователя. Это раскрывающееся меню, где вы можете изменить данные аккаунта текущего пользователя, сменить пароль 2 способами (через секретный вопрос или через старый пароль) и выйти из аккаунта.

# Немного о БД
В БД есть 2 таблицы: User и Mail.
В **User** есть 7 полей:
1) User_id - идентификатор пользователя, первичный ключ.
2) Full_name - ФИО пользователя.
3) Date_of_birth - день рождения пользователя.
4) Login - логин, указываемый пользователем при регистрации и с помощью которого происходит вход в систему.
5) Password - пароль от аккаунта.
6) Secret_question - секретный вопрос для восстановление пароля
7) Answer - ответ на секретный вопрос.

В Mail содержится 9 полей:
1) User_id - внешний ключ, идентификатор пользователя.
2) Mail_id - первичный ключ, идентификатор письма.
3) Title - название(тема) письма
4) Date - дата отправки письма
5) Sender_login - логин отправителя письма
6) Receiver_login - логин получателя письма
7) Text - текст самого письма
8) Is_read - прочитано ли письмо
9) Is_deleted - помещено ли письмо в корзину

# Вспомогательная информация
Чтобы увидеть вводимый пароль в окне Register и Recovery Password, нажмите F1. Чтобы сгенерировать случайный пароль в соответствующих окнах, нажмите F2. Эту же информацию можно получить, если навести на поле ввода Password, тогда выскочит всплывающая подсказка (ToolTip) Требования к паролю прописаны в **Модули и их назначение: Модуль Password**.
Варианты логина будут сгенерированы автоматически, когда вы введете ФИО. Они будут содержать окончание "python.com". Это окончание необязательно и вы можете придумать свой логин.
Некоторые варианты секретных вопросов тоже сгенерированы в программе, но вы можете придумать и свой.
Вы можете изменять данные в БД по своему усмотрению, но ломать программу через открытую БД будет варварством =)


# Модули и их назначение
Всего в приложении реализовано 12 основных модулей (не считая самих форм, которые были преобразованы к классам с помощью утилиты pyuic). 
## Модуль Login
С этого окна начинается взаимодействие с программой. Здесь пользователь вводит свой логин и пароль, чтобы пройти этапы идентификации и  аутентификации. Если логин и пароль верный, то авторизация прошла успешна, выдаем права пользователю и переходим к следующей части программы. 
Если пользователь не помнит свой пароль, он может восстановить его через секретный вопрос, нажав на ссылку "Забыли пароль?".
Если пользователь не зарегистрирован в системе, он может зарегистрироваться при нажатии на ссылку "Нет аккаунта? Зарегистрируйтесь".

## Класс Register
В этом окне вводятся данные для добавления нового пользователя в БД. Данные для ввода:
- ФИО
- Дата рождения
- Логин
- Пароль
- Повторение пароля
- Секретный вопрос для восстановления пароля
- Ответ на секретный вопрос

Надежный пароль можно сгенерировать программно, если нажать F2. Тогда поля "Пароль" и "Повторение пароля" автоматически заполнятся. Так как пароли в поле ввода изначально скрыты, чтобы их увидеть, нужно нажать F1. Повторное нажатие F1 снова скроет пароль.
Если все данные заполнены корректно, то регистрация пройдёт успешно и новый пользователь добавится в БД.
## Модуль Password
Вспомогательный модуль, в котором реализованы классы исключений:
- PasswordError - класс-родитель. Наследуется от Exception
- LengthError - Ошибка длины пароля. Исключение поднимается, если пароль содержит менее 8 символов. Наследуется от PasswordError
- LetterError- Ошибка символов в пароле. Исключение поднимается, если в пароле содержатся символы только одного регистра. Наследуется от PasswordError
- DigitError - Ошибка цифр в паролею Исключение поднимается, если пароль не содержит не одну цифру. Наследуется от PasswordError

Пароль проверяется по всем критериям и если он не соответствует одному или нескольким критериям, то выбрасывается исключение.
Также, в модуле реализована генерация паролей из любого количества символов, который соответствует всем критериям.

## Класс RecoveryPassword
Обеспечивает восстановления пароля через секретный вопрос или путём ввода старого пароля.

## Модуль FrameLayout
Красивая выпадающая менюшка, реализованная не мной, а вот этим автором: __author__ = 'Caroline Beyne'. Ссылка на проект в GitHub: https://github.com/yunatoomi/pyqt-collapsible-widget/blob/master/code/FrameLayout.py

## Модуль Label
Реализует класс ClickableLabel наследуемый от QLabel. Позволяет сделать Label кликабельными.

## Класс Mail
Основная функциональность содержится здесь. Реализует просмотр и чтение писем, их удаление, можно отметить письма как прочитанные/непрочитанные.Эта функциональность реализуется через QTableWidget. В нем хранятся id письма, тема, дата отправки, получатель, отправитель и текст письма. Письмо можно открыть двойным кликом или правой кнопкой мыши + открыть меню. Можно выбрать письма, которые пришли в определенную дату с помощью виджета QCalendarWidget, выбрать определенные категории писем с помощью ClickableLabel. Доступные категории:
- Все письма
- Прочитанные письма
- Непрочитанные письма
- Письма, отправленные вами
- Письма, полученные вами
- Корзина, куда можно переносить письма и удалить их окончательно

Также, реализован поиск по письмам с помощью поисковой строки сверху.

## Класс MessageRead
Открывает отдельное окно для чтения информации о письме и его текста.

## Класс WriteMessage
Открывает отдельное окно, где можно указать тему, получателя и текст самого письма. Получатель должен быть обязательно заполнен и он должен быть зарегистрирован.

## Класс ChangeProfileData
Отдельное окно, где можно изменить данные аккаунта, такие как: ФИО, дата рождения, секретный вопрос и ответ на него.

## Класс Constants
Содержит некоторые константы, например, название БД.